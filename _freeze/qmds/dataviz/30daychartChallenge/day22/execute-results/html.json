{
  "hash": "68b69253e99b37fe1755ce7a7699911b",
  "result": {
    "markdown": "---\ntitle: \"Day 22\" \ndate: '2022-04-22'\nimage: plots/day22_dcc_22.gif\ncategories:\n  - Data Viz \n  - ggplot2\n  - Data analysis\ndescription: 'Day 22 from #30dataChartChallenge'\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics('plots/day22_dcc_22.png')\n```\n\n::: {.cell-output-display}\n![](plots/day22_dcc_22.png){width=1800}\n:::\n\n```{.r .cell-code}\nknitr::include_graphics('plots/day22_dcc_22.gif')\n```\n\n::: {.cell-output-display}\n![](plots/day22_dcc_22.gif)\n:::\n:::\n\n\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrarian::shelf(\n  tidyverse\n  , PeruData\n  , lubridate\n  , gganimate\n  , gifski\n)\ntc_i <- \"data/bcrp/tc1.xlsx\"\nbcrp_get(\"tc\", \"1/1 /2021\", \"5/5/2022\", tc_i)\ntc <- readxl::read_xlsx(here::here(tc_i), skip = 1) |> \n  rename(\n    f = 1\n    , tc = 2\n  )\nSys.setlocale(\"LC_ALL\", \"Spanish\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntc1 <-\n  tc |> \n  mutate(\n    f = str_replace_all(f, \"Set\", \"Sep\")\n    , f1 = str_to_lower(f)\n    , f2 = paste(str_sub(f1, 1, 5), \".\", str_sub(f1, 6, -1), sep = \"\")\n    , f = dmy(f2) \n    , anio = year(f)\n    , tc = as.numeric(tc)\n  ) |> \n  filter(\n    f > dmy(\"31/12/2020\")\n    , month(f) < month(5)\n  ) |>\n  arrange(desc(f)) |> \n  drop_na() |> \n  select(!f1:f2) |> \n  # group_by(anio) |> \n  # mutate(f = row_number()) |> \n  mutate(f = ifelse(year(f) == 2021, f + years(1), f)) |>\n  pivot_wider(names_from = anio, values_from = tc) |> \n  mutate(f = lubridate::as_date(f)) |> \n  drop_na() |> \n  pivot_longer(!f)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npa <- \n  tc1 |> \n  # filter(name == \"2021\") |>\n  arrange(f) |> \n  ggplot() +\n  aes(f, value, color = name) +\n  geom_point(size = 4.3) +\n  # geom_line() +\n  geom_step(size = 2, direction = \"mid\") +\n  scale_color_manual(values = c(\"#db6b20\", \"#265e8e\"))+\n  cowplot::theme_minimal_hgrid() +\n  labs(\n    color = \"\"\n    , x = \"\"\n    , y = \"\"\n    , title = \"Per√∫: 2021 - 2022\"\n    , subtitle = \"Movimiento del Tipo de Cambio Interbancario\"\n    , caption = \"#30DayChartChallenge | Day 22: Animation\\nData: BCRP |  @JhonKevinFlore1\"\n  ) +\n  guides(\n    linetype = guide_legend(\n      override.aes = list(\n        size = 1\n      )\n    )\n  ) +\n  # transition_reveal(id = f, along = f) +\n  scale_x_date(date_breaks = \"5 weeks\", date_labels = \"%B %d\") +\n  theme(\n    legend.position = c(.45, .8)\n    , panel.grid.major = element_line(linetype = 4, color = \"gray30\")\n    , panel.grid.major.x = element_line(linetype = 4, color = \"gray60\")\n    , plot.caption = element_text(hjust = .5, color = \"grey50\", size = 13)\n    , plot.title = element_text(size = 20)\n    , plot.subtitle = element_text(size = 17)\n    , panel.background = element_rect(\"#f9f3f2\")\n    , plot.background = element_rect(\"#f9f3f2\")\n    , legend.background = element_blank()\n    , legend.text = element_text(size = 16)\n    , legend.key.width = unit(22, \"mm\")\n  )  +\n  transition_reveal(f)\n\nanimate(pa, width = 1200, height = 800, renderer = gifski_renderer('plots/day22_dcc_22.gif'))\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}