{
  "hash": "0ef977fbcc0272ad08f38335a81bc1ef",
  "result": {
    "markdown": "---\ntitle: \"Day 07\" \ndate: '2022-04-07'\nimage: plots/day7_dcc_22.png\ncategories:\n  - R\n  - Data Viz \n  - ggplot2\n  - Data analysis\ndescription: 'Day 7 form #30dataChartChallenge'\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrarian::shelf(\n  tidyverse\n  , ggtext\n  , tidytuesdayR\n  , ggside\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\n  The 'cran_repo' argument in shelf() was not set, so it will use\n  cran_repo = 'https://cran.r-project.org' by default.\n\n  To avoid this message, set the 'cran_repo' argument to a CRAN\n  mirror URL (see https://cran.r-project.org/mirrors.html) or set\n  'quiet = TRUE'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggtext' was built under R version 4.3.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidytuesdayR' was built under R version 4.3.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggside' was built under R version 4.3.1\n```\n:::\n\n```{.r .cell-code}\n# tt_available()\n\ntt <- tt_load(\"2022-03-29\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Compiling #TidyTuesday Information for 2022-03-29 ----\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- There is 1 file available ---\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Starting Download ---\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tDownloading file 1 of 1: `sports.csv`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n--- Download complete ---\n```\n:::\n\n```{.r .cell-code}\nsports <- tt$sports\nglimpse(sports)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 132,327\nColumns: 28\n$ year                 <dbl> 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2…\n$ unitid               <dbl> 100654, 100654, 100654, 100654, 100654, 100654, 1…\n$ institution_name     <chr> \"Alabama A & M University\", \"Alabama A & M Univer…\n$ city_txt             <chr> \"Normal\", \"Normal\", \"Normal\", \"Normal\", \"Normal\",…\n$ state_cd             <chr> \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"AL\", \"…\n$ zip_text             <chr> \"35762\", \"35762\", \"35762\", \"35762\", \"35762\", \"357…\n$ classification_code  <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1…\n$ classification_name  <chr> \"NCAA Division I-FCS\", \"NCAA Division I-FCS\", \"NC…\n$ classification_other <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ ef_male_count        <dbl> 1923, 1923, 1923, 1923, 1923, 1923, 1923, 1923, 1…\n$ ef_female_count      <dbl> 2300, 2300, 2300, 2300, 2300, 2300, 2300, 2300, 2…\n$ ef_total_count       <dbl> 4223, 4223, 4223, 4223, 4223, 4223, 4223, 4223, 4…\n$ sector_cd            <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ sector_name          <chr> \"Public, 4-year or above\", \"Public, 4-year or abo…\n$ sportscode           <dbl> 1, 2, 3, 7, 8, 15, 16, 22, 26, 33, 1, 2, 3, 8, 12…\n$ partic_men           <dbl> 31, 19, 61, 99, 9, NA, NA, 7, NA, NA, 32, 13, NA,…\n$ partic_women         <dbl> NA, 16, 46, NA, NA, 21, 25, 10, 16, 9, NA, 20, 68…\n$ partic_coed_men      <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ partic_coed_women    <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ sum_partic_men       <dbl> 31, 19, 61, 99, 9, 0, 0, 7, 0, 0, 32, 13, 0, 10, …\n$ sum_partic_women     <dbl> 0, 16, 46, 0, 0, 21, 25, 10, 16, 9, 0, 20, 68, 7,…\n$ rev_men              <dbl> 345592, 1211095, 183333, 2808949, 78270, NA, NA, …\n$ rev_women            <dbl> NA, 748833, 315574, NA, NA, 410717, 298164, 13114…\n$ total_rev_menwomen   <dbl> 345592, 1959928, 498907, 2808949, 78270, 410717, …\n$ exp_men              <dbl> 397818, 817868, 246949, 3059353, 83913, NA, NA, 9…\n$ exp_women            <dbl> NA, 742460, 251184, NA, NA, 432648, 340259, 11388…\n$ total_exp_menwomen   <dbl> 397818, 1560328, 498133, 3059353, 83913, 432648, …\n$ sports               <chr> \"Baseball\", \"Basketball\", \"All Track Combined\", \"…\n```\n:::\n\n```{.r .cell-code}\nunique(sports$sports)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Baseball\"                   \"Basketball\"                \n [3] \"All Track Combined\"         \"Football\"                  \n [5] \"Golf\"                       \"Soccer\"                    \n [7] \"Softball\"                   \"Tennis\"                    \n [9] \"Volleyball\"                 \"Bowling\"                   \n[11] \"Rifle\"                      \"Beach Volleyball\"          \n[13] \"Ice Hockey\"                 \"Lacrosse\"                  \n[15] \"Gymnastics\"                 \"Rowing\"                    \n[17] \"Swimming and Diving\"        \"Track and Field, X-Country\"\n[19] \"Equestrian\"                 \"Track and Field, Indoor\"   \n[21] \"Track and Field, Outdoor\"   \"Wrestling\"                 \n[23] \"Other Sports\"               \"Rodeo\"                     \n[25] \"Skiing\"                     \"Swimming\"                  \n[27] \"Water Polo\"                 \"Archery\"                   \n[29] \"Field Hockey\"               \"Fencing\"                   \n[31] \"Sailing\"                    \"Badminton\"                 \n[33] \"Squash\"                     \"Diving\"                    \n[35] \"Synchronized Swimming\"      \"Table Tennis\"              \n[37] \"Weight Lifting\"             \"Team Handball\"             \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsport_diff <- \n  sports |> \n  select(contains(c(\"rev\", \"exp\"))) |> \n  select(!contains(\"total\")) |> \n  gather() |> \n  separate(key, c(\"tipo\", \"sex\"), sep = \"_\") |> \n  drop_na(value) \n\nsport_w <- \n  sport_diff |> \n  group_by(tipo) |> \n  mutate(id = row_number()) |> \n  pivot_wider(names_from = tipo, values_from = value) |> \n  ungroup() |> \n  select(!id) |> \n  mutate(sex = ifelse(sex == \"men\", \"Hombres\", \"Mujeres\"))\npal_col <- c(\n  \"#008e5f\"\n  , \"#f1007d\"\n)\nsport_w |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  sex         rev     exp\n  <chr>     <dbl>   <dbl>\n1 Hombres  345592  397818\n2 Hombres 1211095  817868\n3 Hombres  183333  246949\n4 Hombres 2808949 3059353\n5 Hombres   78270   83913\n6 Hombres   78274   99612\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np <- \n  sport_w |> \n  group_by(sex) |> \n  # slice(1:2000) |> \n  mutate(across(c(rev, exp), log)) |> \n  ggplot() +\n  aes(exp, rev, color = sex) +\n  geom_point(alpha = .1) +\n  scale_color_manual(\n    values = pal_col\n  ) +\n  scale_x_continuous(breaks = seq(5, 20, by = 5)) +\n  scale_y_continuous(breaks = seq(5, 20, by = 5)) +\n  geom_xsidedensity(aes(y = stat(density), xfill = sex), alpha = .2) +\n  scale_xfill_manual(values = pal_col) +\n  geom_ysidedensity(aes(x = stat(density), yfill = sex), alpha = .2) +\n  scale_yfill_manual(values = pal_col) +\n  ggside(x.pos = \"bottom\", y.pos = \"right\") +\n  # '<span style=\"color:#595a52\">Índice de Desarrollo Humano</span>\n  ggtitle(\n    '<span style=\"color:#db3a04\">**Gastos**</span> y <span style=\"color:#305c99\">**Retornos**</span> generados($)'\n    , \"Equipos deportivos de Estados Unidos (Escala logarítmica)\"\n  ) +\n  labs(\n    x = \"Gastos\"\n    , y = \"Retornos\"\n    , caption = \"Data: Equily in Athletics - Tidytuesday {2022-03-29} | Viz: @JhonKevinFlore1\\n#30DayChartChallenge | Day7: Physical\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = c(.7, .2)\n    , plot.margin = margin(1, 1, .5, 1, \"cm\")\n    , panel.grid.minor = element_blank()\n    , panel.grid.major = element_line(color = \"white\")\n    , panel.background = element_rect(fill=\"grey95\", color = \"white\")\n    , plot.background = element_rect(fill=\"grey85\", color = \"white\")\n    , plot.caption = element_text(hjust = .5)\n    , plot.title = element_markdown(hjust = .5)\n    , axis.title.x = element_text(color = \"#db3a04\", face = \"bold\")\n    , axis.title.y = element_text(color = \"#305c99\", face = \"bold\")\n    , legend.background = element_blank()\n    , legend.key = element_rect(fill = \"white\", color = NA)\n    , legend.text = element_text(color =\"gray50\", size = 13)\n    , legend.key.width = unit(12, \"mm\")\n    , legend.title = element_blank()\n    \n  )\np\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `stat(density)` was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(density)` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing non-finite values (`stat_density()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](day7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np_name <- 'plots/day7_dcc_22.png'\nggsave(\n  p_name, \n  plot = p,\n  width = 12, \n  height = 8\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing non-finite values (`stat_density()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_point()`).\n```\n:::\n\n```{.r .cell-code}\nknitr::include_graphics(p_name)\n```\n\n::: {.cell-output-display}\n![](plots/day7_dcc_22.png){width=1800}\n:::\n:::\n",
    "supporting": [
      "day7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}