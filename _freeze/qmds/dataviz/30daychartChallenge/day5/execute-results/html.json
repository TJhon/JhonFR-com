{
  "hash": "9668de3bdf8e397e558d1b8326633bdf",
  "result": {
    "markdown": "---\ntitle: \"Day 05\" \ndate: '2022-04-05'\nimage: plots/day5_dcc_22.png\ncategories:\n  - R\n  - Data Viz \n  - ggplot2\n  - Data analysis\ndescription: 'Day 5 form #30dataChartChallenge'\n---\n\n::: {.cell}\n\n```{.r .cell-code}\np_name = 'plots/day5_dcc_22.png'\nknitr::opts_chunk$set(\n  eval = F\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrarian::shelf(\n  tidyverse\n  , PeruData\n  , ggtext\n)\n\n# Enaho, P524A1 ingresos\n# p207 sexo\n# p510 ocupacion principal para\n# \n# \n\nvari <- c(\"p524a1\", \"p207\", \"p510\")\n\n#data\n\n# PeruData::inei_enaho(\"05\", c(\"2010\", \"2020\"))\n\nenaho <- dir(here::here(\"Data\", \"enaho\", \"solo-data\"), recursive = T, pattern = \".dta\", full.names = T)\n\nsemi_clean <- function(dir){\n  enaho <- \n    haven::read_dta(dir) |> \n    janitor::clean_names()\n  Sys.sleep(5)\n  variables <- \n    enaho |> \n    select(any_of(vari)) |> \n    rename(ing = 1, sex = 2, ocu = 3) |> \n    drop_na() |> \n    group_by(ocu, sex) |> \n    summarise(ing_mean = mean(ing), n = n())\n  Sys.sleep(5)\n  return(variables)\n}\n\nenaho_data <- \n  map(enaho, semi_clean) |> \n  map_dfr(ungroup, .id = \"anio\") |> \n  mutate(\n    anio = ifelse(anio == 1, 2010, 2020)\n    , sex = ifelse(sex ==1, \"Hombre\", \"Mujer\")\n  )\n\nbg <- \"#132A3F\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nenaho_data |> \n  mutate(\n    ocu = haven::as_factor(ocu)\n    # , anio = factor(anio, c(2010, 2020))\n    , n_per = BBmisc::normalize(n, \"range\", c(1, 3))\n  ) |> \n  filter(ocu != \"Cooperativa de trabajadores\") |> \n  \n  ggplot() +\n  aes(\n    anio, ing_mean, group = interaction(ocu, sex), color = sex, linetype = ocu, shape = sex\n      ) +\n  ggtitle(\n    \"Perú\"\n    , subtitle = glue::glue(\"Salarios promedios del Peru 2010, 2020<br> con la librería **PeruData**\")\n  ) +\n  labs(\n     caption = \"Data: INEI - Peru | Viz: @JhonKevinFlore1 | #30DayChartChallenge | Day5: Slope\"\n    \n  ) +\n  scale_color_manual(values = c(\"#df4576\", \"#238ad3\")) +\n  geom_line(size = 1.4)  +\n  geom_point(size = 5.4) +\n  scale_x_continuous(breaks = c(2010, 2020)) +\n  guides(\n    linetype = guide_legend(\n      override.aes = list(\n        color = \"white\"\n        , size = 1\n        )\n    )\n  ) +\n  theme(\n    plot.background = element_rect(bg)\n    , panel.background = element_rect(bg)\n    , axis.text = element_text(color = \"grey90\", size = 14)\n    , axis.line = element_line(color = \"grey90\") \n    , axis.title = element_blank()\n    , panel.grid = element_blank()\n    , legend.background = element_rect(NA)\n    , legend.key = element_rect(NA, color = bg)\n    , legend.text = element_text(color =\"white\", size = 13)\n    , legend.key.width = unit(22, \"mm\")\n    , legend.title = element_blank()\n  \n    , legend.position = c(.3, .8)\n    , plot.title = element_text(\n      hjust = .5, color = \"#f24915\"\n      , size = 25, face = \"bold\"\n      )\n    # , plot.subtitle = element_text(\n    #   hjust = .5, color = \"#f2b715\"\n    #   , size = 20\n    # \n    # )\n    , plot.subtitle = element_markdown(\n      hjust = .5, color = \"#f2b715\"\n      , size = 20\n    )\n    , plot.caption = element_text(\n      hjust = .5, color = \"grey80\"\n      , size = 13\n      , \n    )\n    , plot.margin = unit(rep(12, 4), \"mm\")\n  )  \n\nggsave(\n  height = 8 \n  , width = 12\n  , filename = \"plots/day5_dcc_22.png\"\n\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics('plots/day5_dcc_22.png')\n```\n\n::: {.cell-output-display}\n![](plots/day5_dcc_22.png){width=1800}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}