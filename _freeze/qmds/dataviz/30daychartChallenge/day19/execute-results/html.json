{
  "hash": "3387515b3d82143e0c21f9ba36cb1634",
  "result": {
    "markdown": "---\ntitle: \"Day 19\" \ndate: '2022-04-19'\nimage: plots/day19_dcc_22.gif\ncategories:\n  - R\n  - Data Viz \n  - ggplot2\n  - Data analysis\ndescription: 'Day 19 from #30dataChartChallenge'\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::include_graphics('plots/day19_dcc_22.gif')\n```\n\n::: {.cell-output-display}\n![](plots/day19_dcc_22.gif)\n:::\n:::\n\n\n\n## Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrarian::shelf(\n  tidyverse\n  , gapminder\n  , sf\n  , maps\n)\n\npover <- \n  read_csv(here::here(\"data\", \"owd\", \"extreme-poverty.csv\")) |> \n  rename(\n    country = 1\n    , year = 3\n    , pover = 4\n  ) |> \n  mutate(\n    country = ifelse(str_detect(country, \"Argentina\"), \"Argentina\", country)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nam_cnt <- \n  pover |> \n  left_join(gapminder, by = \"country\") |> \n  filter(\n    continent == \"Americas\"\n    ) |> \n  distinct(country) |> \n  pull()\n\npover_latam <-\n  pover |> \n  filter(country %in% am_cnt) |> \n  # distinct(country) |> \n    # pull()\n  select(!Code) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlatim <-\n  map_data(\"world\") |> as_tibble() |> rename(country = region) |> \n  filter(country %in% am_cnt) |> \n  right_join(pover_latam) |> \n  filter(country != \"Canada\")\n\nt2 <- colorRampPalette(c(\"#ead9d5\", '#560100'))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_fill <- function(anio){\n  cli::cli_process_start(\"year {.val {anio}}\")\n  p <- latim |> \n    filter(year == anio) |> \n    ggplot() +\n    aes(long, lat, group = paste(country, group), fill = pover) +\n    geom_polygon(color = \"gray90\", size = .23) +\n    coord_fixed() +\n    scale_fill_gradientn(colors = t2(2)) +\n    labs(\n      title = glue::glue(\"Latinoam√©rica - Pobreza extrema\", \"\\n{anio}\")\n      , caption = \"#30DayChartChallenge | Day 19: Global Change\\nData: OWID |  @JhonKevinFlore1\"\n      , fill = \"%\"\n    ) +\n    guides(\n      fill = guide_colorbar(\n        direction = \"horizontal\"\n        , title.position = \"top\"\n        , title.hjust = .5\n        , label.hjust = .5\n        , label.position = \"bottom\"\n        , keywidth = .2\n        , keyheight = .2\n        \n      )\n    ) +\n    theme_void() +\n    # hrbrthemes::theme_ft_rc(grid = FALSE, axis_text_size = 0) +\n    theme(\n      legend.position = c(.3, .35)\n      , legend.text = element_text()\n      , plot.title = element_text(hjus = .5, face = \"bold\")\n      , plot.subtitle = element_text( hjust = .5)\n      , plot.caption = element_text(hjust = 1, vjust = .5)\n      , plot.caption.position = 'panel'\n    )\n  plot(p)\n  cli::cli_process_done()\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_fill(\"1989\")\nggsave(here::here(\"plots\", \"day19.png\"))\n\nanimation::saveGIF({\n  purrr::walk(unique(pover_latam$year), plot_fill)\n  } , movie.name = here::here('plots/day19_dcc_22.gif')\n  , interval = .5\n  , ani.width = 1385\n  , ani.height = 1500\n  , ani.res = 300\n)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}